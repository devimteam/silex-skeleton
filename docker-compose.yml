version: '2'
services:
  web:
    image: nginx
    ports:
      - "8089:80"
    volumes:
      - ./docker/config/local/nginx/default.conf:/etc/nginx/conf.d/default.conf
      - ./:/var/data
    links: [fpm]

  fpm:
    build: .
    environment:
      APP_ENV: "local"
      COMPOSER_CACHE_DIR: /var/data/composer
    volumes:
      - ./:/var/www
      - ./docker/config/local/fpm/www.conf:/etc/php/7.1/fpm/pool.d/www.conf
      - ./docker/config/local/fpm/php.ini:/etc/php/7.1/fpm/php.ini
      - ./docker/config/local/fpm/php.ini:/etc/php/7.1/cli/php.ini
      - composer_data:/var/data/composer

volumes:
  composer_data:
    driver: local
